<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.dong.inquiry.CommentDAO">

  <!-- 댓글 목록 (부모 → 자식 순서 정렬) -->
  <select id="list" parameterType="int" resultType="kr.co.dong.inquiry.CommentDTO">
    SELECT * FROM comment
    WHERE inquiryId = #{inquiryId}
    ORDER BY COALESCE(id), id ASC
  </select>

  <!-- 댓글 등록 -->
  <insert id="insert" parameterType="kr.co.dong.inquiry.CommentDTO">
    INSERT INTO comment (inquiryId, writer, content,regdate)
    VALUES (#{inquiryId}, #{writer}, #{content}, NOW())
  </insert>

  <!-- 댓글 삭제 (관리자 전용) -->
  <delete id="delete" parameterType="int">
    DELETE FROM comment WHERE id = #{id} 
  </delete>

  <!-- 댓글 삭제 (작성자 본인만) -->
  <delete id="deleteByOwner" parameterType="map">
    DELETE FROM comment 
    WHERE (id = #{id} )
      AND writer = #{writer}
  </delete>

</mapper>
